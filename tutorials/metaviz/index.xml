<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Metaviz-rsses on Epiviz</title>
    <link>https://epiviz.github.io/tutorials/metaviz/index.xml</link>
    <description>Recent content in Metaviz-rsses on Epiviz</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 22 Nov 2016 14:12:05 -0500</lastBuildDate>
    <atom:link href="https://epiviz.github.io/tutorials/metaviz/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Metaviz Tutorials</title>
      <link>https://epiviz.github.io/tutorials/metaviz/</link>
      <pubDate>Tue, 22 Nov 2016 14:12:05 -0500</pubDate>
      
      <guid>https://epiviz.github.io/tutorials/metaviz/</guid>
      <description>

&lt;h3 id=&#34;tutorials&#34;&gt;Tutorials&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;overview&#34;&gt;post 1: Metaviz Quick Overview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;metagenomeSeq&#34;&gt;post 2: Differential Analysis with MetagenomeSeq and Metaviz&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Metaviz Quick Overview</title>
      <link>https://epiviz.github.io/tutorials/metaviz/overview/</link>
      <pubDate>Tue, 24 Jan 2017 14:08:04 -0500</pubDate>
      
      <guid>https://epiviz.github.io/tutorials/metaviz/overview/</guid>
      <description>

&lt;p&gt;This post introduces the most compelling User Interface features of Metaviz.  An in-depth overview of an entire visual analysis will be posted in the next few days.&lt;/p&gt;

&lt;h2 id=&#34;novel-navigation-utility-for-exploring-taxonomic-hierarchies&#34;&gt;Novel Navigation Utility for Exploring Taxonomic Hierarchies&lt;/h2&gt;

&lt;p&gt;Effectively navigating the hierarchical space of features for metagenomic data is challenging. Metaviz is designed specifically to address this. The Metaviz workspace displayed below includes a &amp;lsquo;FacetZoom&amp;rsquo; object that shows a limited section of the taxonomic hierarchy at one time.  A &amp;lsquo;FacetZoom&amp;rsquo; object can be used to explore the observed features in the dataset and aggregate counts to specific nodes or levels in the taxonomic hierarchy.  We will introduce &amp;lsquo;FacetZoom&amp;rsquo; functionality as needed throughout this workflow.  A &amp;lsquo;FacetZoom&amp;rsquo; object controls the views of data visualizations we will add in the next sections.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/FacetZoomInitial.png&#34; alt=&#34;Facet Zoom Initial View&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;heatmap-linked-to-taxonomic-hierarchy&#34;&gt;Heatmap Linked to Taxonomic Hierarchy&lt;/h2&gt;

&lt;p&gt;The next feature is linked charts that update on exploration with the ‘FacetZoom’ navigation object.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/HeatmapFacetZoomColorsCompleted.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;pca-plots&#34;&gt;PCA Plots&lt;/h2&gt;

&lt;p&gt;Metaviz also provides PCA ordination plots with the samples colored by a selected attribute.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/PCASettingsSelected.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;stacked-bar-plots&#34;&gt;Stacked Bar Plots&lt;/h2&gt;

&lt;p&gt;With Metaviz, a user can create Stacked Bar Plots and group by or order by a given attribute. A user can also make separate charts for case and control samples for comparison.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/StackedPlotCaseGroupBy.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;text-search&#34;&gt;Text Search&lt;/h2&gt;

&lt;p&gt;Complementary to the ‘FacetZoom’ object, Metaviz provides text-based search which can be used by typing in the text box in the menu bar &amp;lsquo;Text Based Search&amp;rsquo; to search for specific taxonomic features.&lt;/p&gt;

&lt;p&gt;Choose &amp;lsquo;Firmucutes&amp;rsquo;, &amp;lsquo;phylum&amp;rsquo; from the drop down menu. This will move the navigation bar to encompass that item.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/TextSearchTypingFirmicutes.png&#34; alt=&#34;&#34; /&gt;
Beyond text-based search, the navigation bar can be moved, expanded, and reduced by using either the controls in the left-hand corner of the FacetZoom object or by dragging the red ends of the navigation bar.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/NavigationWidgetNavBarExpandAll.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;aggregation-at-any-set-of-nodes-in-hierarchy&#34;&gt;Aggregation at any set of nodes in hierarchy&lt;/h2&gt;

&lt;p&gt;Now we will navigate the FacetZoom object to see selections update the heatmap and stacked line plots.&lt;/p&gt;

&lt;p&gt;You can interact with the FacetZoom object by clicking on any node.  Clicking on a node at a lower level than the root of the hierarchy will render a new subtree.  Each node can is in one of three states: (1) expanded, which means that the children of the node are shown in visualizations, (2) aggregated, which means that the counts for all children nodes are summed to that node, or (3) removed, which means that the node and all of its children are removed from visualizations.&lt;/p&gt;

&lt;p&gt;To show the states, we click through on the first node of the second row &amp;lsquo;Proteobacteria&amp;rsquo; and then we also click directly on the node to show a new subtree and explore the feature hierarchy. To set aggregation for an entire level, adjust the row control to set the aggregation to another level.  Click on the fourth item, with an &amp;lsquo;F&amp;rsquo; standing for &amp;lsquo;Family&amp;rsquo; and now all counts are summed to the Family level nodes across the samples in the charts.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/NavigationWidgetTraverseHierarchySetFamily.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Next, we change the aggregation level back to Order and navigate to have &amp;lsquo;Bacteria&amp;rsquo; as the root of the FacetZoom.  We then set some nodes to &amp;lsquo;expanded&amp;rsquo;, &amp;lsquo;removed&amp;rsquo;, and &amp;lsquo;aggregated&amp;rsquo;. We made the following selections based on the appearance of the heatmap.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/NavigationBarRemovingAggregatingNodes.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Finally, we see the highlight of the path in the hierarchy and across the heatmaps and stacked plots.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/NavigationBarHighlightingPath.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In upcoming posts we will include a more detailed example of the usage of Metaviz, including how to integrate with R/Bioconductor for statistical analysis of metagenomic datasets.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Differential Analysis with MetagenomeSeq and Metaviz</title>
      <link>https://epiviz.github.io/tutorials/metaviz/metagenomeSeq/</link>
      <pubDate>Tue, 17 Jan 2017 14:08:04 -0500</pubDate>
      
      <guid>https://epiviz.github.io/tutorials/metaviz/metagenomeSeq/</guid>
      <description>

&lt;p&gt;In this post we will show how to use Metaviz along with the Bioconductor package metagenomeSeq to perform a statistical and visual analysis of differential abundance of metagenomic data.&lt;/p&gt;

&lt;p&gt;First, the following libraries will need to be downloaded and loaded:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r, eval=FALSE&#34;&gt;library(metagenomeSeq)
library(msd16s)
library(metavizr)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;generating-metagenomeseq-objects-and-computing-differential-abundance&#34;&gt;Generating metagenomeSeq objects and computing differential abundance&lt;/h2&gt;

&lt;p&gt;In an R session we will use &lt;code&gt;metagenomeSeq&lt;/code&gt; to compute differential abundance.  We focus on the &lt;code&gt;msd16s&lt;/code&gt; dataset and its 301 samples from Bangladesh.&lt;br /&gt;
In &lt;code&gt;metagenomeSeq&lt;/code&gt;, we first subset the data to only Bangladesh samples, aggregate the count data to the species level, and normalize the count data.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r, eval=FALSE&#34;&gt;aggregated_feature_order &amp;lt;- colnames(fData(msd16s))[3:9]

msd16s_species &amp;lt;- msd16s
fData(msd16s) &amp;lt;- fData(msd16s)[feature_order]
fData(msd16s_species) &amp;lt;- fData(msd16s_species)[aggregated_feature_order]
  
bangladesh &amp;lt;- msd16s[, which(pData(msd16s)$Country == &amp;quot;Bangladesh&amp;quot;)]
bangladesh_species &amp;lt;- msd16s_species[, which(pData(msd16s_species)$Country == &amp;quot;Bangladesh&amp;quot;)]

aggregated_species &amp;lt;-  cumNorm(aggregateByTaxonomy(bangladesh_species, lvl=&amp;quot;species&amp;quot;), p = 0.75)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We then aggregate another copy of the Bangladesh subset to aggregate to the &amp;ldquo;class&amp;rdquo; level, normalize count data, and compute differential abundance at the &amp;ldquo;class&amp;rdquo; level between dysentery cases and controls.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r, eval=False&#34;&gt;aggregation_level &amp;lt;- &amp;quot;class&amp;quot;
aggregated_bangladesh &amp;lt;- aggregateByTaxonomy(bangladesh, lvl=aggregation_level)

normed_bangladesh &amp;lt;-  cumNorm(aggregated_bangladesh, p = 0.75)
bangladesh_sample_data &amp;lt;-  pData(normed_bangladesh)
mod &amp;lt;-  model.matrix(~1+Dysentery, data = bangladesh_sample_data)
results_bangladesh &amp;lt;-  fitFeatureModel(normed_bangladesh, mod) # Check: ?results_bangladesh
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can then extract a list of bacterial classes that have a log fold-change greater than 2 and an FDR adjusted p-value less than .1 between dysentery case and control samples from Bangladesh. Once we have this list of differentially abundant classes, we propagate them to an MRexperiment at &amp;ldquo;species&amp;rdquo; level to visualize and explore these results.  The differential abundance cutoff can be set to a different threshold and the aggregation level can also be changed to examine the dataset.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r, eval=FALSE&#34;&gt;logFC_bangladesh &amp;lt;- MRcoefs(results_bangladesh, number = nrow(normed_bangladesh))

feature_names &amp;lt;- rownames(logFC_bangladesh[which(logFC_bangladesh[which(abs(logFC_bangladesh$logFC) &amp;gt; 1),]$adjPvalues &amp;lt; .1),]) 
fSelection &amp;lt;- generateSelection(feature_names = feature_names , aggregation_level = aggregation_level, selection_type =2)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;creating-metavizr-object&#34;&gt;Creating metavizR object&lt;/h2&gt;

&lt;p&gt;The next step will be to launch a Metaviz instance from the R session, add a &amp;lsquo;FacetZoom&amp;rsquo; object, modify the node selections to show those nodes that are differentially abundant, and add a heatmap showing only species within differentially abundant classes.
Load the &amp;lsquo;metavizr&amp;rsquo; package and create a Metaviz instance by calling&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r, eval=FALSE&#34;&gt;app &amp;lt;- startMetaviz()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will open a new Metaviz session on the default browser.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/AppInitial.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Then, to add a FacetZoom object of the msd16s hierarchy the following call is made to create a Metaviz control object then add a plot.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r, eval=FALSE&#34;&gt;control &amp;lt;- metavizr::metavizControl(featureSelection = fSelection)
icicle_plot &amp;lt;- app$plot(aggregated_species, datasource_name=&amp;quot;msd16s&amp;quot;, control=control, feature_order = aggregated_feature_order)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &amp;lsquo;plot&amp;rsquo; function adds the object to the Metaviz session.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/IciclePlotPushed.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;adding-heatmap&#34;&gt;Adding heatmap&lt;/h2&gt;

&lt;p&gt;This step is simple using metavizr, all that needs to be done is call the &amp;lsquo;revisualize&amp;rsquo; method to add another visualization of the same data.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r, eval=FALSE&#34;&gt;heatmap &amp;lt;- app$chart_mgr$revisualize(chart_type = &amp;quot;HeatmapPlot&amp;quot;, chart = icicle_plot)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now a heatmap is added to the Metaviz workspace.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/HeatmapAdded.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;modifying-settings-and-exploring-with-the-facetzoom-object&#34;&gt;Modifying Settings and Exploring with the FacetZoom object&lt;/h2&gt;

&lt;p&gt;Now we modify chart settings to customize the visualization for our purposes. We group-by Dysentery and modify the color settings. To accomplish this we click on the &amp;lsquo;Custom settings&amp;rsquo; icon.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/HeatmapSettingsHover.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;This launches a pop-up dialog window with all available chart settings.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/HeatmapSettingsPopup.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The first setting to change is the &amp;lsquo;Row labels&amp;rsquo; which will be set to &amp;lsquo;Dysentery&amp;rsquo;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/HeatmapSettingsDysentery.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Next, move the &amp;lsquo;Row labels as colors&amp;rsquo; radio control to &amp;lsquo;On&amp;rsquo;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/HeatmapSettingsGroupByOn.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Now the heatmap rows will colored by the &amp;lsquo;Dysentery&amp;rsquo; status.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/HeatmapSettingsComplete.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;We would then like to update the settings of the color scheme.  From the popup window, We select an RColorBrewer template which is appropriate.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/HeatmapColorSettings.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Now the Metaviz workspace colors are set.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/HeatmapColorSettingsComplete.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;As with a FacetZoom object added from the UI, a user can modify node states in order to examine the statistical test result.  We modify the navigation widget by changing the &amp;lsquo;Actinobacteria&amp;rsquo; status from removed to aggregated.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/NavigationWidgetActino.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;We can then hover on the new column of the heatmap to highlight the path through the hierarchy.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/NavigationWidgetActinoHover.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;A user can also traverse the hierarchy and change the aggregation setting for all nodes at a given level. To show this utility, we navigate to a lower level of the hierarchy by clicking on the &amp;lsquo;Proteobacteria&amp;rsquo; node and set the aggregation level to &amp;lsquo;Genus&amp;rsquo; by clicking on the row control node.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/NavigationWidgetDescendProteoBacteriaSetGenusAsAgg.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Then we can hover on a column that appears to show a difference between case and control samples.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://epiviz.github.io/tutorials/images/metaviz/NavigationWidgetHeatmapHoverShigella.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>